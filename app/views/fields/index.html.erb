<% require "byebug" %>

<div class="container">
<% console %>
<h1>FIELDS</h1>
  <% @fields.each do |field| %>
    <%= cl_image_tag(field.photo,
        width: 400, height: 300, crop: :fill) %>
    <p> <%= field.business.name %></p>
    <p> <%= field.name %></p>
    <p> Capacidad: <%= field.capacity %></p>
    <p> Precio: <%= number_to_currency(field.price_cents/100, precision: 0)    %></p>
    <p> <%= field.business.address %></p>
    <p>Disponibilidad: </p>

    <!-- Disponibilidad... Pensar la forma en la que esto se puede hacer en el controller y no en el view -->
    <% hours_booked = [] %>
    <% Booking.where(field_id: field.id).each do |booking| %>
      <% hours_booked << booking.date.hour %>
    <% end  %>
    <% horas = (17..24).to_a %>

    <% horas.each do |hora| %>
      <% unless hours_booked.include?(hora) %>
        <p><%= hora %></p>
      <% end  %>
    <% end %>
    <% hours_booked = [] %>
  <% end %>

  <div
    id="map"
    style="width: 100%;
    height: 600px;"
    data-markers="<%= @markers.to_json %>"
  ></div>

</div>
